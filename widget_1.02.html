<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="styles1.01.css">
  <title>Example Select Widget v1.01</title>
</head>
<body class="no-widget">
 <!-- <h1>Example Select Widget v1.01</h1>
  <p>For this example if Javascript is not working we will fall back to displaying the standard <b>&lt;select&gt;</b> element. To do so we add the regular <b>&lt;select&gt;</b> element before each use of the cusotm widget. Then we need to add two new classes to let us hide whichever element is not running. We can then use a CSS selector to hide the unused element. By default the HTML code hides the custom widget too.</p>
<div class="no-widget"> -->
  <!-- Begin Form -->
  <form>
    <select name="iceCream" >
      <option>Banana</option>
      <option>Chocolate</option>
      <option>Vanilla</option>
      <option>Strawberry</option>
      <option>Bubblegum</option>
    </select>
<!--
  <div class="select">
    <span class="value">Banana</span>
      <ul class="optList hidden">
        <li class="option">Banana</li>
        <li class="option">Chocolate</li>
        <li class="option">Vanilla</li>
        <li class="option">Strawberry</li>
        <li class="option">Bubblegum</li>
      </ul>
  </div>
-->
</form>
<!-- This script will use the standard DOM API to do the work.
  These are the features we will use:
  - class list (riskiest)
  - addEventListener
  - ForEach (not DOM, modern JS)
  - querySelector and querySelectorAll
-->
<script>
  // Add forEach to NodeList to treat it like an Array
  NodeList.prototype.forEach = function (callback) {
    Array.prototype.forEach.call(this,callback);
  }

  // Event Callbacks
  // here we define the functions used when the user interacts with the widget

  // function to deactivate the custom widget
  // takes one parameter
  // select : the DOM node with the `select` class to deactivate
  function deactivateSelect(select) {
    // if the widget is not active there is nothing to do
    if (!select.classList.contains('active')) return;

    // get the list of options for the widget
    var optList = select.querySelector('.optList');

    // close the list of options
    optList.classList.add('hidden');

    // deactivate the custom widget itself
    select.classList.remove('active');
  }

  // This function is used each time the user activates/deactivates the widget
  // two parameters
  // select : the DOM node with the `select` class to activate
  // selectList : the list of all the DOM nodes with the `select` class
  function activeSelect(select, selectList) {
    // If the widget is active do nothing
    if (select.classList.contains('active')) return;

    // We need to turn off the active state on all custom widgets
    // because the deactivateSelect function fulfills all requirements of the
    // forEach callback function, we use it directly rather than as an intermediate anonymous function
    selectList.forEach(deactivateSelect);

    // ...and we turn on the active state for this specific widget
    select.classList.add('active');
  }

  // Each time the user wants to open or close the option list, this function is used
  // one parameter
  // select : the DOM node with the list to toggle
  function toggleOptList(select) {
    
    // the list is kept from the widget
    var optList = select.querySelector('.optlist');

    // Change the class of the list to show/hide it
    optList.classList.toggle('.hidden');
  }

  // This function is used each time we need to highlight the option list
  // two parameters
  // select : the DOM node with the `select` class containing the list option to highlight
  // option : the DOM node with the `option` class to highlight
  function highlightOption(select, option) {

    // First, get the list of all option(s) available for the custom select element
    var optionList = select.querySelectorAll('.option');

    // Remove the highlight form all options
    optionList.forEach(function (other) {
      other.classList.remove('highlight');
    });
    
    // highlight the correct option
    option.classList.add('highlight');
  };

// TODO: bind functions to the appropriate events

</script>
</body>
</html>
